<!-- Copyright (c) 2024 Climate Interactive / New Venture Fund -->

<!-- SCRIPT -->
<script lang='ts'>

import Row from './trace-row.svelte'
import type { TraceViewModel } from './trace-vm'

export let viewModel: TraceViewModel
const running = viewModel.running
const groups = viewModel.groups

function onRun() {
  viewModel.run()
}

</script>




<!-- TEMPLATE -->
<template>

<div class="trace-container">
  <div class="trace-header-container">
    {#if !$running}
      <button class="run" on:click={onRun} disabled={$running}>Run</button>
    {:else}
      <div>Running comparisons, please waitâ€¦</div>
    {/if}
  </div>
  <div class="trace-scroll-container">
    {#each $groups as group}
      <div class="trace-group">
        <div class="trace-group-title">{group.title}</div>
        {#each group.rows as row}
          <Row viewModel={row} />
        {/each}
      </div>
    {/each}
  </div>
</div>

</template>




<!-- STYLE -->
<style lang='sass'>

.trace-container
  display: flex
  flex-direction: column
  flex: 1

.trace-header-container
  display: flex
  flex-direction: column
  align-items: flex-start
  // XXX: Use negative margin to make the shadow stretch all the way
  // across, then use extra padding to compensate
  margin: 0 -1rem
  padding: 0 2rem 1rem 2rem
  box-shadow: 0 1rem .5rem -.5rem rgba(0,0,0,.5)
  z-index: 1

.trace-scroll-container
  display: flex
  // XXX: We use 1px here for flex-basis, otherwise in Firefox and Chrome the
  // whole page will scroll instead of just this container.  See also:
  //   https://stackoverflow.com/a/52489012
  flex: 1 1 1px
  flex-direction: column
  overflow: auto
  padding: 1rem
  align-items: flex-start
  outline: none
  background-color: #3c3c3c

.trace-group
  display: flex
  flex-direction: column
  &:not(:first-child)
    margin-top: 20px

.trace-group-title
  font-size: 14px
  font-weight: 700
  color: #fff
  margin-bottom: 4px

</style>
